version: 2.1

orbs:
  win: circleci/windows@5.0 

workflows:
  poc:
    jobs:
      - test-multiline:
          matrix:
            parameters:
              shell: [bash, sh, cmd, powershell, '']

jobs:
  orbs-on-windows:
    parameters:
      executor:
        type: string
      shell:
        type: string
    executor:
      name: << parameters.executor >>
      shell: << parameters.shell >>
    steps:
      - checkout
      - run:
          name: Check jq output
          command: cat template.json | jq '@json' > jq_output.txt
      - store_artifacts:
          path: .
      - slack/notify:
          debug: true
  control:
    docker:
      - image: cimg/base:stable
    steps:
      - checkout 
      - run:
          name: Check jq output
          command: cat template.json | jq '@json' > jq_output.txt
      - store_artifacts:
          path: .
      - slack/notify:
          debug: true
  test-multiline:
    executor: win/default
    parameters:
      shell:
        type: string
    steps:
      - checkout 
      - run:
          name: Check multiline command
          command: |
            echo "line 1"
            echo
            echo "line 3"
          shell: << parameters.shell >>